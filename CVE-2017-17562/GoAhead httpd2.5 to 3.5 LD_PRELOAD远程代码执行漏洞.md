# GoAhead httpd2.5 to 3.5 LD_PRELOAD远程代码执行漏洞（CVE-2017-17562)

GoAhead Web Server 被爆出在3.6.5之前的所有版本中存在一个远程代码执行漏洞（CVE-2017-17562）。该漏洞源于使用不受信任的HTTP请求参数初始化分叉CGI脚本环境，并且会影响所有启用了动态链接可执行文件（CGI脚本）支持的用户。当与glibc动态链接器结合使用时，使用特殊变量（如LD_PRELOAD）就可以实施远程代码执行。2017年12月18日针对该漏洞利用的PoC公开，请受影响的用户及时更新版本进行修复。

## 影响范围

受影响的版本

GoAhead Web Server < 3.6.5

## 漏洞分析

可以按照下列方法克隆、编译并运行包含漏洞的GoAhead守护进程代码库：

    $ git clone https://github.com/embedthis/goahead.git
    $ cd goahead/
    $ git checkout tags/v3.6.4 -q
    $ make > /dev/null
    $ cd test
    $ gcc ./cgitest.c -o cgi-bin/cgitest
    $ sudo ../build/linux-x64-default/bin/goahead

## 漏洞检测

版本检测使用以下命令：

    $ build/linux-x64-default/bin/goahead --version

或者使用POC检测验证：

    # python makemyday.py --server 192.168.1.1 --port 80 exploit --payload ./payloads/x86_64-hw.so

